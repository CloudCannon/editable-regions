---
// Import public client variables defined in astro.config.mjs env.schema
import { PUBLIC_API_URL, PUBLIC_FEATURE_FLAG } from "astro:env/client";

// Import getSecret from server module (shimmed - will log warning)
import { getSecret } from "astro:env/server";

import EnvDisplay from "../components/env-display.astro";

// Test getSecret (shimmed - will log warning)
const secretValue = getSecret("SECRET_API_KEY");
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>astro:env Test Page</title>
    <script>
      import("../../live-editing");
    </script>
  </head>
  <body>
    <h1>astro:env Module Tests</h1>

    <section>
      <h2>astro:env/client - Public Variables</h2>
      <p>PUBLIC_API_URL: {PUBLIC_API_URL}</p>
      <p>PUBLIC_FEATURE_FLAG: {String(PUBLIC_FEATURE_FLAG)}</p>
    </section>

    <section>
      <h2>astro:env/server - getSecret()</h2>
      <p><em>getSecret is shimmed and will log a warning to console</em></p>
      <p>getSecret("SECRET_API_KEY") result: {secretValue ?? "undefined"}</p>
    </section>

    <section>
      <h2>Editable Env Component</h2>
      <div data-editable="component" data-component="env-display">
        <EnvDisplay title="Editable Env Display">
          <p data-editable="source" data-path="src/pages/env.astro" data-key="env-display-content">This is an editable component using astro:env.</p>
        </EnvDisplay>
      </div>
    </section>
  </body>
</html>
